name: "读书笔记数据库"
description: "管理阅读书籍的进度、笔记和评价"

filters:
  and:
    - file.hasTag("书籍")
    - file.name != ""

properties:
  作者:
    displayName: "作者"
  译者:
    displayName: "译者"
  出版社:
    displayName: "出版社"
  出版年份:
    displayName: "出版年份"
    type: "number"
  总页数:
    displayName: "总页数"
    type: "number"
  已读页数:
    displayName: "已读页数"
    type: "number"
  开始日期:
    displayName: "开始日期"
    type: "date"
  完成日期:
    displayName: "完成日期"
    type: "date"
  分类:
    displayName: "分类"
    type: "select"
    options: ["技术", "商业", "心理学", "历史", "文学", "哲学", "科学", "其他"]
  评分:
    displayName: "评分 (1-5)"
    type: "number"
    min: 1
    max: 5
  阅读状态:
    displayName: "阅读状态"
    type: "select"
    options: ["想读", "在读", "已读完", "暂停", "放弃"]
  推荐度:
    displayName: "推荐度"
    type: "select"
    options: ["强烈推荐", "推荐", "一般", "不推荐"]

formulas:
  阅读进度: '(已读页数 / 总页数 * 100).toFixed(1)'
  阅读状态显示: 'if(阅读进度 == 100, "✅ 已读完", if(阅读进度 > 0, "📖 阅读中 " + 阅读进度 + "%", "⏳ 想读"))'
  进度条: '"■".repeat(Math.floor(阅读进度/10)) + "□".repeat(10-Math.floor(阅读进度/10)) + " " + 阅读进度.toFixed(1) + "%"'
  阅读天数: '(today() - 开始日期).toFixed(0)'
  评分星级: '"⭐".repeat(评分) + "☆".repeat(5-评分)'
  是否逾期: '阅读状态 == "在读" and (today() - 开始日期) > 30'
  平均每日页数: 'if(阅读天数 > 0, (已读页数 / 阅读天数).toFixed(1), 0)'

views:
  - type: table
    name: "阅读清单"
    filters:
      and:
        - '阅读状态 != "已读完"'
        - '阅读状态 != "放弃"'
    order:
      - 优先级
      - 开始日期
    sort:
      - 优先级: "asc"
      - 开始日期: "desc"
    columns:
      - file.name
      - 作者
      - 分类
      - 阅读状态
      - 阅读进度
      - 进度条
      - 开始日期
      - 阅读天数

  - type: kanban
    name: "阅读状态看板"
    groupBy: 阅读状态
    order:
      - 评分
      - 开始日期
    sort:
      - 评分: "desc"
      - 开始日期: "desc"

  - type: table
    name: "已读完书籍"
    filters:
      and:
        - '阅读状态 == "已读完"'
    order:
      - 完成日期
      - 评分
    sort:
      - 完成日期: "desc"
      - 评分: "desc"
    columns:
      - file.name
      - 作者
      - 分类
      - 总页数
      - 评分
      - 评分星级
      - 推荐度
      - 完成日期
      - 阅读天数

  - type: table
    name: "书籍推荐"
    filters:
      and:
        - '评分 >= 4'
        - '推荐度 == "强烈推荐" or 推荐度 == "推荐"'
    order:
      - 评分
      - 推荐度
    sort:
      - 评分: "desc"
      - 推荐度: "asc"
    columns:
      - file.name
      - 作者
      - 分类
      - 评分
      - 评分星级
      - 推荐度
      - 总页数

  - type: calendar
    name: "阅读日历"
    dateProperty: 完成日期
    filters:
      and:
        - '阅读状态 == "已读完"'